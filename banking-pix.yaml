openapi: 3.0.2
info:
  title: Pix
  version: "1.1"

security:
 - basicAuth: []

tags:
 - name: Dict
   description: Diretório de Identificadores de Contas Transacionais  
 - name: Reivindicação e Portabilidade
   description: Reivindicar ou solicitar a portabilidade de uma chave   
 - name: Pix
   description: Realiza pagamentos e transferências por Pix  

servers: [
    {
      "url": "https://apigw-sandbox.zoop.ws",
      "description": "Sandbox"
    },    
    {
      "url": "https://api-beta.zoop.ws",
      "description": "Produção"
    }
    ]
    
paths:
  "/v3/marketplaces/{marketplace_id}/bankig/dict/holders/{holder_id}/accounts/{account_id}/entries":
    post:
      parameters:
        - $ref: "#/components/parameters/marketplaceID"
        - $ref: "#/components/parameters/holderID"
        - $ref: "#/components/parameters/accountID"
        - $ref: "#/components/parameters/XAuthTokenReading"
        - $ref: "#/components/parameters/XSessionToken"
      summary: Criar chave de endereçamento
      tags:
        - Dict
      requestBody:
        required: true
        content:
          application/json:
            schema:
               $ref: '#/components/schemas/DictKeyRequest'
      responses:
        '200':
          description: OK - A chave de endereçamento foi incluída com sucesso e está pronta para o uso
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DictKeyResponse'
        '202':
          description: Accepted - Indica que a requisição de criação de chave foi recebida com sucesso, porém ela necessita de intervenção do usuário para sua conclusão ou não pode ser concluída imediatamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DictKeyResponse202'
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/DictKeyResponse400'
                  - $ref: '#/components/schemas/DictKeyResponse4002'
                  - $ref: '#/components/schemas/DictKeyResponse4003'
                  - $ref: '#/components/schemas/DictKeyResponse4004'
                  - $ref: '#/components/schemas/DictKeyResponse4005'
        '404':
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DictKeyResponse404'
        '412':
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DictKeyResponse412'
    get:
      parameters:
        - $ref: "#/components/parameters/marketplaceID"
        - $ref: "#/components/parameters/holderID"
        - $ref: "#/components/parameters/accountID"
        - $ref: "#/components/parameters/offsetID"
        - $ref: "#/components/parameters/sizeID"
      summary: Listar vínculos com chaves de endereçamento
      tags:
        - Dict
      responses:
        '200':
          description: OK - A chave de endereçamento foi incluída com sucesso e está pronta para o uso
          content:
            application/json:
              schema:
                type: object
                properties:
                  items:
                    type: array
                    items:
                      $ref: '#/components/schemas/DictKeyResponse'
                  has_more: 
                    type: boolean
                    example: false
                  limit: 
                    type: integer
                    example: 1
                  total_pages: 
                    type: integer
                    example: 1
                  page: 
                    type: integer
                    example: 1
                  offset: 
                    type: integer
                    example: 1
                  total: 
                    type: integer
                    example: 1
                  query_count: 
                    type: integer
                    example: 1
                  
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/DictKeyResponse400'
  "/v3/marketplaces/{marketplace_id}/bankig/dict/holders/{holder_id}/accounts/{account_id}/entries/{entry_id}/ownership":
    post:
      parameters:
        - $ref: "#/components/parameters/marketplaceID"
        - $ref: "#/components/parameters/holderID"
        - $ref: "#/components/parameters/accountID"
        - $ref: "#/components/parameters/entryID"
        - $ref: "#/components/parameters/XAuthTokenReading"
        - $ref: "#/components/parameters/XSessionToken"
      summary: Confirmar propriedade de chave de endereçamento
      tags:
        - Dict
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                code: 
                  type: string
                  description: Código de verificação de propriedade enviado para o usuário de acordo com o tipo de chave escolhido. Campo alfanumérico de 4 caracteres.
                  example: 4040
                  required:
                    - "code"
      responses:
        '200':
          description: OK
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/DictKeyResponse400'
                  - $ref: '#/components/schemas/DictKeyResponse4002'
                  - $ref: '#/components/schemas/DictKeyResponse4003'
                  - $ref: '#/components/schemas/DictKeyResponse4004'
                  - $ref: '#/components/schemas/DictKeyResponse4005'
        '404':
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DictKeyResponse404'
        '412':
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DictKeyResponse412'
    get:
      parameters:
        - $ref: "#/components/parameters/marketplaceID"
        - $ref: "#/components/parameters/holderID"
        - $ref: "#/components/parameters/accountID"
        - $ref: "#/components/parameters/offsetID"
        - $ref: "#/components/parameters/sizeID"
      summary: Listar vínculos com chaves de endereçamento
      tags:
        - Dict
      responses:
        '200':
          description: OK - A chave de endereçamento foi incluída com sucesso e está pronta para o uso
          content:
            application/json:
              schema:
                type: object
                properties:
                  items:
                    type: array
                    items:
                      $ref: '#/components/schemas/DictKeyResponse'
                  has_more: 
                    type: boolean
                    example: false
                  limit: 
                    type: integer
                    example: 1
                  total_pages: 
                    type: integer
                    example: 1
                  page: 
                    type: integer
                    example: 1
                  offset: 
                    type: integer
                    example: 1
                  total: 
                    type: integer
                    example: 1
                  query_count: 
                    type: integer
                    example: 1
                  
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/DictKeyResponse400'



components:
  securitySchemes:
     basicAuth:
       type: http
       scheme: basic 
  parameters:
      marketplaceID:
        name: marketplace_id
        in: path
        description: ID do marketplace
        required: true
        schema:
          type: string
      holderID:
        name: holder_id
        in: path
        description: Token de leitura do 2FA
        required: true
        schema:
          type: string
      referenceID:
        name: reference_id
        in: path
        description: Id de referencia informado na solicitação da TED
        required: true
        schema:
          type: string
      externalTransferID:
        name: externalTransfer_id
        in: path
        description: Id gerado da transferência quando bem sucedida
        required: true
        schema:
          type: string
      paymentID:
        name: payment_id
        in: path
        description: ID do pagamento 
        required: true
        schema:
          type: string
      barcodeID:
        name: barcode
        in: path
        description: Identificacao do barcode
        required: true
        schema:
          type: string
      accountID:
        name: account_id
        in: path
        description: ID da conta digital 
        required: true
        schema:
          type: string
      p2p_transferID:
        name: p2p_transfer_id
        in: path
        description: ID da transferência entre contas 
        required: true
        schema:
          type: string
      phoneID:
        name: phone_id
        in: path
        description: ID do telefone 
        required: true
        schema:
          type: string
      type:
        name: type_id
        in: query
        description: Tipo do arquivo a ser enviado
        required: true
        schema:
          type: string
          enum:
            - SELFIE
            - RG_FRENTE
            - RG_VERSO
            - CNH_FRENTE
            - CNH-VERSO
            - CCMEI
            - PAGINA_CONTRATO_SOCIAL
            - PAGINA_ESTATUTO_SOCIAL
            - PAGINA_ATA_ELEICAO_DIRETORES
            - PAGINA_PROCURACAO
      documentID:
        name: documents_id
        in: path
        description: ID do documento
        required: true
        schema:
          type: string
      adressID:
        name: address_id
        in: path
        description: ID do endereço
        required: true
        schema:
          type: string
      pageID:
        name: page_id
        in: query
        description: indica a página que será exibida
        schema:
          type: number
          example: 0
      sizeID:
        name: size_id
        in: query
        description: Quantidade de registros a ser retornado por página
        schema:
          type: number
          example: 20
      offsetID:
        name: offset
        in: query
        description: Determina o ponto de inicio dos registros retornados
        schema:
          type: number
          example: 0
      limitID:
        name: limit
        in: query
        description: Quantidade máxima de itens por página (<100)
        schema:
          type: number
          example: 0
      typeOpID:
        name: type
        in: query
        description: "Retorna lançamentos onde o tipo da operação seja igual a um dos valores informado. O valor pode ser uma string ou uma lista de valores concatenados por ', '. (ex: charge, charge_refunded, transfer, transfer_refunded, deposit, deposit_refunded, adjustment)"
        required: true
        schema:
          type: string
          enum:
            - charge
            - charge_refunded
            - transfer
            - transfer_refunded
            - deposit
            - deposit_refunded
            - adjustment
      entryID:
        name: entry_id
        in: path
        description: Id da chave de endereçamento
        schema:
          type: number
          example: 0
      created_date_rangeID:
        name: created_date_range
        in: query
        description: Retorna lançamentos onde a data for igual o valor informado. O valor pode ser uma string com um horário em UTC timestamp ou ISO (YYYY-DD-MM HH:MM:SS)
        schema:
          type: string
          example: "2020-10-01 15:34:00"
      created_date_rangeGTID:
        name: created_date_range[gt]
        in: query
        description: Retorna lançamentos onde a data for maior o valor informado
        schema:
          type: string
          example: "2020-10-01 15:34:00"
      created_date_rangeLTID:
        name: created_date_range[lt]
        in: query
        description: Retorna lançamentos onde a data for menor o valor informado
        schema:
          type: string
          example: "2020-10-01 15:34:00"
      created_date_rangeGTEID:
        name: created_date_range[gte]
        in: query
        description: Retorna lançamentos onde a data for maior ou igual o valor informado
        schema:
          type: string
          example: "2020-10-01 15:34:00"
      created_date_rangeLTEID:
        name: created_date_range[lte]
        in: query
        description: Retorna lançamentos onde a data for menor ou igual valor informado
        schema:
          type: string
          example: "2020-10-01 15:34:00"
      XAuthTokenReading:
        name: X-Auth-Token-Reading
        in: header
        description: Token de leitura do 2FA
        required: true
        schema:
          type: string
      XSessionToken:
        name: X-Session-Token
        in: header
        description: Token de sessão do 2FA
        required: true
        schema:
          type: string

  schemas:
    DictKeyRequest:
      type: object
      properties:
        type:
          type: string
          description: Representa o tipo de chave de endereçamento. 
          enum:
           - phone
           - email
           - evp
           - national_registration
          
        value:
          type: string
          description: Representa o valor da chave de endereçamento. Seu formato e tamanho variam conforme o tipo escolhido anteriormente. Para phone a mascara é +9999999999999. Para email a mascara é xxxxxxxxxx@xxxxxxx.xx.xx com máximo de 77 caracteres. Para evp, não deve ser informado nenhum valor. Para national_registration, não deve ser informado nenhum valor.
    DictKeyResponse:
      type: object
      properties:
        id:
          type: string
          example: "29b0000cb501400ea6c3f21b24ef251c"
        status:
          type: string
          example: "active"
        created_at:
          type: string
          example: "2020-11-06T12:54:11.336975"
        updated_at:
          type: string
          example: "2020-11-06T12:54:11.336975"
        key:
          type: object
          properties:
            value:
              type: string
              example: "33580667033"
            type:
              type: string
              example: national_registration
        account:
          type: object
          properties:
            id:
              type: string
              example: "cf27477574e04d4584ac75ef6ca5ec3f"
            marketplace_id:
              type: string
              example: "6c237bf9932840ccada92ac629a05d39"
            holder_id:
              type: string
              example: "d83a1a81caa243d2a10bc414ae406bd3"
            owner:
              type: object
              properties:
                name:
                  type: string
                  example: João da Silva
                national_registration:
                  type: string
                  example: "33580667033"
                type:
                  type: string
                  example: "individual"
            routing_number:
              type: string
              example: "001"
            number:
              type: string
              example: "456123"
            type:
              type: string
              example: "cacc"
        psp:
          type: object
          properties:
            code: 
              type: string
              example: "3001155"
            name:
              type: string
              example: "Zoop"
    DictKeyResponse202:
      type: object
      properties:
        id:
          type: string
          example: "29b0000cb501400ea6c3f21b24ef251c"
        status:
          type: string
          example: "active"
        created_at:
          type: string
          example: "2020-11-06T12:54:11.336975"
        updated_at:
          type: string
          example: "2020-11-06T12:54:11.336975"
        key:
          type: object
          properties:
            value:
              type: string
              example: "fulano@gmail.com"
            type:
              type: string
              example: email
        account:
          type: object
          properties:
            id:
              type: string
              example: "cf27477574e04d4584ac75ef6ca5ec3f"
            marketplace_id:
              type: string
              example: "6c237bf9932840ccada92ac629a05d39"
            holder_id:
              type: string
              example: "d83a1a81caa243d2a10bc414ae406bd3"
            owner:
              type: object
              properties:
                name:
                  type: string
                  example: João da Silva
                national_registration:
                  type: string
                  example: "33580667033"
                type:
                  type: string
                  example: "individual"
            routing_number:
              type: string
              example: "001"
            number:
              type: string
              example: "456123"
            type:
              type: string
              example: "cacc"
        psp:
          type: object
          properties:
            code: 
              type: string
              example: "3001155"
            name:
              type: string
              example: "Zoop"
    DictKeyResponse400:
      type: object
      properties:
        code:
          type: string
          example: "1000"
        message:
          type: string
          example: "Account Id is required"
    DictKeyResponse4001:
      type: object
      properties:
        code:
          type: string
          example: "1001"
        message:
          type: string
          example: "Key value is not a valid email format"
    DictKeyResponse4002:
      type: object
      properties:
        code:
          type: string
          example: "1002"
        message:
          type: string
          example: "Key of type phone must have 14 characters for its value"
    DictKeyResponse4003:
      type: object
      properties:
        code:
          type: string
          example: "1003"
        message:
          type: string
          example: "Key value is required for phone or email types"
    DictKeyResponse4004:
      type: object
      properties:
        code:
          type: string
          example: "1004"
        message:
          type: string
          example: "Key type is no compatible with claim type"
    DictKeyResponse4005:
      type: object
      properties:
        code:
          type: string
          example: "1005"
        message:
          type: string
          example: "Key value must not be informed for national_registration or evp types"
    DictKeyResponse404:
      type: object
      properties:
        code:
          type: string
          example: "3000"
        message:
          type: string
          example: "Marketplace not found"
    DictKeyResponse412:
      type: object
      properties:
        code:
          type: string
          example: "4000"
        message:
          type: string
          example: "Maximum entry count allowed reached"

    billTransferRequest:
      type: object
      properties:
        to:
          type: string
          description: ID da conta de destino a ser creditada pela transferência
          example: 0
        amount:
          type: integer
          description: Valor em centavos a ser transferidoo
        description:
          type: string
          description: Descrição da transferência
          example: 0
        statement_descriptor:
          type: integer
          description: Descrição a ser exibida no extrato de lançamentos das contas
        reference_id:
          type: string
          description: Valor de referência da transferência no seu sistema
        metadata:
          type: object
          description: 'Metadados associados a transferência, no formato objeto "chave": "valor"'
    billTransferResponse:
      type: object
      properties:
        id:
          type: string
          example: "942e0d178dd64644b2eb054705268c94"
        resource:
          type: string
          example: "p2p_transfer"
        type:
          type: string
          example: "payment"
        status:
          type: string
          example: "payment"
        confirmed:
          type: string
          example: "1"
        recipient:
          type: string
          example: "2c42a9b1dea541b5a12aacd32b0fdb4d"
        sender:
          type: string
          description: "800bcd574b7743078dedb5e2c9414ae7"
        amount:
          type: string
          example: 0.01
        fee:
          type: string
          example: 0.00
        net_amount:
          type: string
          example: 0.01
        currency:
          type: string
          description: "BRL"
        description:
          type: string
          example: "use com moderacao"
        statement_descriptor:
          type: string
          example: null
        bank_account:
          type: string
          example: null
        transfer_date:
          type: string
          description: "2019-08-14T18:25:22+00:00"
        created_at:
          type: string
          example: "2019-08-14T18:25:22+00:00"
        updated_at:
          type: string
          example: "2019-08-14T18:25:22+00:00"
        metadata:
          type: object
        from:
          type: object
          properties:
            id:
              type: string
              example: "b9602ec221a64f8897eb883eed72592e"
            account: 
              type: object
              properties:
                id:
                  type: string
                  example: "cb2a0ed4ead9473c9b304d560ab83107"
                holder: 
                  type: string
                  example: "b8c7cce7618e41618170cf45948b7af0"
                balance:
                  type: string
                  description: "1.06"
                currency:
                  type: string
                  example: "BRL"
                routing_number:
                  type: string
                  example: 001
                number:
                  type: string
                  example: "72925596"
                status:
                  type: string
                  example: "active"
                metadata:
                  type: object
                object_type:
                  type: string
                  example: "payment"
                created_at:
                  type: string
                  example: "2020-11-06T12:54:11.336975"
                updated_at:
                  type: string
                  example: "2020-11-06T12:54:11.336975"
                primary:
                  type: boolean
                  enum:
                    - true
                    - false
                  default: true
                resource:
                  type: string
                  example: "payment_account"
            amount: 
                type: string
                example: "-0.13"
            gross_amount: 
                type: string
                example: "-0.13"
            nsu: 
                type: integer
                example: 11
            date: 
                type: string
                example: "2019-08-15T15:04:29.848403"
            fee: 
                type: string
                example: "0.00"
            object_type: 
                type: string
                example: "transfer"
            object_id: 
                type: string
                example: "442b0729ff874c0d84deb905dbb18745"
            type: 
                type: string
                example: "transfer"
            created_at: 
                type: string
                example: "2019-08-15T15:04:29.729921"
            dflag: 
                type: string
                example: "active"
            authorization: 
                type: object
                properties:
                  external_key:
                    type: string
                    example: "2ed672d431054261913d0e16daf6024a"
                  type:
                    type: string
                    example: "transfer"
                  status:
                    type: string
                    example: "active"
            transfer: 
                type: object
                properties:
                  id:
                    type: string
                    example: "b9602ec221a64f8897eb883eed72592e"
                  authorization_code:
                    type: string
                    example: "ec68f18543aa45a3b88aaddbb6be616e"
            resource:
              type: string
              example: "payment_account.entry"
        to:
          type: object
          properties:
            id:
              type: string
              example: "b9602ec221a64f8897eb883eed72592e"
            account: 
              type: object
              properties:
                id:
                  type: string
                  example: "cb2a0ed4ead9473c9b304d560ab83107"
                holder: 
                  type: string
                  example: "b8c7cce7618e41618170cf45948b7af0"
            amount: 
                type: string
                example: "0.13"
            gross_amount: 
                type: string
                example: "0.13"
            nsu: 
                type: integer
                example: 9
            date: 
                type: string
                example: "2019-08-15T15:04:29.848403"
            fee: 
                type: string
                example: "0.00"
            current_balance: 
                type: string
                example: "2.04"
            object_type: 
                type: string
                example: "transfer"
            object_id: 
                type: string
                example: "b4137edf22724c1bbb902e0e40669260"
            type: 
                type: string
                example: "transfer"
            created_at: 
                type: string
                example: "2019-08-15T15:04:29.729921"
            dflag: 
                type: string
                example: "active"
            authorization: 
                type: object
                properties:
                  external_key:
                    type: string
                    example: "2ed672d431054261913d0e16daf6024a"
                  type:
                    type: string
                    example: "transfer"
                  status:
                    type: string
                    example: "active"
            transfer: 
                type: object
                properties:
                  id:
                    type: string
                    example: "e513ba702e2648c9b8fb5772c028ff90"
                  authorization_code:
                    type: string
                    example: "ec68f18543aa45a3b88aaddbb6be616e"
            resource:
              type: string
              example: "payment_account.entry"
              
    billTransferError402Response:
      type: object
      properties:
        status:
          type: string
          example: "payment_required"
        type:
          type: string
          example: "invalid_state"
        message:
          type: string
          example: "Insufficient funds"
        category:
          type: string
          example: "business"
        status_code:
          type: number
          example: 402

    TedTransferRequest:
      type: object
      required:
        - amount
        - recipient
      properties:
        amount: 
          type: number
          description: Valor em centavos a ser transferido
          example: 400
        recipient:
          description: Conjunto referente ao recebedor da transferência
          type: object
          properties:
            bank_code:
              type: string
              description: Código do banco de destino - parâmetro pertencente ao objeto recipient (utilizar 208 para TED com destino Zoop)
              example: "208"
            routing_number: 
              type: string 
              description: 'Número da agencia da conta de destino - parâmetro pertencente ao objeto recipient (Utilizar 0025 para TED com destino Zoop)'           
              example: "0025"
            routing_check_digit:
              type: string
              description: Digito verificador da agencia da conta de destino - parâmetro pertencente ao objeto recipient
              example: "01"
            account_number:
              type: integer
              description: Número da conta de destino - parâmetro pertencente ao objeto recipient
              example: "10101010"
            account_check_digit:
              type: string
              description: Digito verificador da conta de destino - parâmetro pertencente ao objeto recipient
              example: "01"
            document:
              type: string
              description: CPF/CNPJ da conta de destino - parâmetro pertencente ao objeto recipient
              example: 99467256000170
            name:
              type: object
              description: Nome do beneficiário do TED - parâmetro pertencente ao objeto recipient
              example: "Zoop"
        description: 
          type: string
          description: Descrição da transferência
          example: "Transferência Bancária"
        reference_id: 
          type: string
          description: Identificador único para a transferência
          example: "7acb2cec-0f18-482c-a508-3eade9367ba3"
        purpose_code: 
          type: string
          description: Código do propósito do envio da TED. Se não informado, o valor considerado será 10 (crédito em conta)
          example: 10
          default: 10
    TedTransferResponse:
      type: object
      properties:
        external_transfer_id:
          type: object
          example: 2a53965957814b30a065a2bb5d25bf67
        amount: 
          type: number
          description: Valor em centavos a ser transferido
          example: 400
        formated_amount: 
          type: string
          description: Valor em centavos a ser transferido
          example: "4.00"
        description: 
          type: string
          example: "Transferência Bancária"
        reference_id: 
          type: string
          example: "7acb2cec-0f18-482c-a508-3eade9367ba3"
        status: 
          type: string
          example: "AUTHORIZED"
        recipient:
          description: Conjunto referente ao recebedor da transferência
          type: object
          properties:
            bank_code:
              type: string
              description: Código do banco de destino - parâmetro pertencente ao objeto recipient (utilizar 208 para TED com destino Zoop)
              example: "208"
            routing_number: 
              type: string 
              description: 'Número da agencia da conta de destino - parâmetro pertencente ao objeto recipient (Utilizar 0025 para TED com destino Zoop)'           
              example: "0025"
            routing_check_digit:
              type: string
              description: Digito verificador da agencia da conta de destino - parâmetro pertencente ao objeto recipient
              example: "01"
            account_number:
              type: integer
              description: Número da conta de destino - parâmetro pertencente ao objeto recipient
              example: "10101010"
            account_check_digit:
              type: string
              description: Digito verificador da conta de destino - parâmetro pertencente ao objeto recipient
              example: "01"
            document:
              type: string
              description: CPF/CNPJ da conta de destino - parâmetro pertencente ao objeto recipient
              example: 99467256000170
            name:
              type: object
              description: Nome do beneficiário do TED - parâmetro pertencente ao objeto recipient
              example: "Zoop"

    TedTransferError400Response:
      type: object
      properties:
        status:
          type: string
          example: "bad_request"
        type:
          type: string
          example: "invalid_request"
        message:
          type: string
          example: "Reference id already exists for this account."
        category:
          type: string
          example: "business"
        status_code:
          type: number
          example: 400
    TedTransferError403Response:
      type: object
      properties:
        status:
          type: string
          example: "Forbidden"
        type:
          type: string
          example: "invalid_request"
        message:
          type: string
          example: "Transfer window is not valid"
        category:
          type: string
          example: "business"
        status_code:
          type: number
          example: 403
    TedTransferError404Response:
      type: object
      properties:
        status:
          type: string
          example: "bad_request"
        type:
          type: string
          example: "invalid_request"
        message:
          type: string
          example: "TED not found"
        category:
          type: string
          example: "business"
        status_code:
          type: number
          example: 404
